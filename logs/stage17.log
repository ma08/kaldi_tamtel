nohup: ignoring input
----------------------- Stage 17 begin---------------------------
Sun May 29 18:11:04 UTC 2022
local/chain/run_tdnn.sh 
Sun May 29 18:11:04 UTC 2022
2022-05-29 18:11:04,744 [steps/nnet3/chain/train.py:35 - <module> - INFO ] Starting chain model trainer (train.py)
2022-05-29 18:11:04,751 [steps/nnet3/chain/train.py:284 - train - INFO ] Arguments for the experiment
{'alignment_subsampling_factor': 3,
 'apply_deriv_weights': False,
 'backstitch_training_interval': 1,
 'backstitch_training_scale': 0.0,
 'chain_opts': '',
 'chunk_left_context': 0,
 'chunk_left_context_initial': -1,
 'chunk_right_context': 0,
 'chunk_right_context_final': -1,
 'chunk_width': '150,110,100',
 'cleanup': True,
 'cmvn_opts': '--config=conf/online_cmvn.conf',
 'combine_sum_to_one_penalty': 0.0,
 'command': 'run.pl',
 'compute_per_dim_accuracy': False,
 'deriv_truncate_margin': None,
 'dir': 'exp/chain_cleaned_1d/tdnn1d_sp',
 'do_final_combination': True,
 'dropout_schedule': '0,0@0.20,0.5@0.50,0',
 'egs_command': None,
 'egs_dir': None,
 'egs_nj': 0,
 'egs_opts': '--frames-overlap-per-eg 0 --constrained false --online-cmvn true',
 'egs_stage': 0,
 'email': None,
 'exit_stage': None,
 'feat_dir': 'data/train_cleaned_sp_hires',
 'final_effective_lrate': 2.5e-05,
 'frame_subsampling_factor': 3,
 'frames_per_iter': 5000000,
 'initial_effective_lrate': 0.00025,
 'input_model': None,
 'l2_regularize': 0.0,
 'lat_dir': 'exp/chain_cleaned_1d/tri3_cleaned_train_cleaned_sp_lats',
 'leaky_hmm_coefficient': 0.1,
 'left_deriv_truncate': None,
 'left_tolerance': 5,
 'lm_opts': '--num-extra-lm-states=2000',
 'max_lda_jobs': 10,
 'max_models_combine': 20,
 'max_objective_evaluations': 30,
 'max_param_change': 2.0,
 'momentum': 0.0,
 'num_chunk_per_minibatch': '64',
 'num_epochs': 6.0,
 'num_jobs_final': 12,
 'num_jobs_initial': 3,
 'num_jobs_step': 1,
 'online_ivector_dir': 'exp/nnet3_cleaned_1d/ivectors_train_cleaned_sp_hires',
 'preserve_model_interval': 100,
 'presoftmax_prior_scale_power': -0.25,
 'proportional_shrink': 0.0,
 'rand_prune': 4.0,
 'remove_egs': True,
 'reporting_interval': 0.1,
 'right_tolerance': 5,
 'samples_per_iter': 400000,
 'shrink_saturation_threshold': 0.4,
 'shrink_value': 1.0,
 'shuffle_buffer_size': 5000,
 'srand': 0,
 'stage': -10,
 'train_opts': ['--optimization.memory-compression-level=2'],
 'tree_dir': 'exp/chain_cleaned_1d/tree_bi',
 'use_gpu': 'wait',
 'xent_regularize': 0.1}
2022-05-29 18:11:06,761 [steps/nnet3/chain/train.py:341 - train - INFO ] Creating phone language-model
2022-05-29 18:11:23,637 [steps/nnet3/chain/train.py:346 - train - INFO ] Creating denominator FST
copy-transition-model exp/chain_cleaned_1d/tree_bi/final.mdl exp/chain_cleaned_1d/tdnn1d_sp/0.trans_mdl 
LOG (copy-transition-model[5.5.1009~1-e4940]:main():copy-transition-model.cc:62) Copied transition model.
2022-05-29 18:11:32,642 [steps/nnet3/chain/train.py:353 - train - INFO ] Initializing a basic network for estimating preconditioning matrix
2022-05-29 18:11:32,704 [steps/nnet3/chain/train.py:382 - train - INFO ] Generating egs
steps/nnet3/chain/get_egs.sh --frames-overlap-per-eg 0 --constrained false --online-cmvn true --cmd run.pl --cmvn-opts --config=conf/online_cmvn.conf --online-ivector-dir exp/nnet3_cleaned_1d/ivectors_train_cleaned_sp_hires --left-context 29 --right-context 29 --left-context-initial -1 --right-context-final -1 --left-tolerance 5 --right-tolerance 5 --frame-subsampling-factor 3 --alignment-subsampling-factor 3 --stage 0 --frames-per-iter 5000000 --frames-per-eg 150,110,100 --srand 0 data/train_cleaned_sp_hires exp/chain_cleaned_1d/tdnn1d_sp exp/chain_cleaned_1d/tri3_cleaned_train_cleaned_sp_lats exp/chain_cleaned_1d/tdnn1d_sp/egs
steps/nnet3/chain/get_egs.sh: File data/train_cleaned_sp_hires/utt2uniq exists, so ensuring the hold-out set includes all perturbed versions of the same source utterance.
steps/nnet3/chain/get_egs.sh: Holding out 300 utterances in validation set and 300 in training diagnostic set, out of total 441906.
steps/nnet3/chain/get_egs.sh: creating egs.  To ensure they are not deleted later you can do:  touch exp/chain_cleaned_1d/tdnn1d_sp/egs/.nodelete
steps/nnet3/chain/get_egs.sh: feature type is raw, with 'apply-cmvn-online'
tree-info exp/chain_cleaned_1d/tdnn1d_sp/tree 
feat-to-dim scp:exp/nnet3_cleaned_1d/ivectors_train_cleaned_sp_hires/ivector_online.scp - 
steps/nnet3/chain/get_egs.sh: working out number of frames of training data
steps/nnet3/chain/get_egs.sh: working out feature dim
steps/nnet3/chain/get_egs.sh: creating 42 archives, each with 49909 egs, with
steps/nnet3/chain/get_egs.sh:   150,110,100 labels per example, and (left,right) context = (29,29)
steps/nnet3/chain/get_egs.sh: Getting validation and training subset examples in background.
steps/nnet3/chain/get_egs.sh: Generating training examples on disk
steps/nnet3/chain/get_egs.sh: Getting subsets of validation examples for diagnostics and combination.
steps/nnet3/chain/get_egs.sh: recombining and shuffling order of archives on disk
steps/nnet3/chain/get_egs.sh: Removing temporary archives, alignments and lattices
steps/nnet3/chain/get_egs.sh: Finished preparing training examples
2022-05-29 18:43:47,760 [steps/nnet3/chain/train.py:431 - train - INFO ] Copying the properties from exp/chain_cleaned_1d/tdnn1d_sp/egs to exp/chain_cleaned_1d/tdnn1d_sp
2022-05-29 18:43:47,822 [steps/nnet3/chain/train.py:445 - train - INFO ] Computing the preconditioning matrix for input features
2022-05-29 18:44:27,918 [steps/nnet3/chain/train.py:454 - train - INFO ] Preparing the initial acoustic model.
2022-05-29 18:44:29,325 [steps/nnet3/chain/train.py:488 - train - INFO ] Training will run for 6.0 epochs = 100 iterations
2022-05-29 18:44:29,326 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 0/99   Jobs: 3   Epoch: 0.00/6.0 (0.0% complete)   lr: 0.000750   
2022-05-29 19:10:24,666 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 1/99   Jobs: 3   Epoch: 0.02/6.0 (0.4% complete)   lr: 0.000743   
2022-05-29 19:30:19,282 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 2/99   Jobs: 3   Epoch: 0.05/6.0 (0.8% complete)   lr: 0.000736   
2022-05-29 19:50:07,520 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 3/99   Jobs: 3   Epoch: 0.07/6.0 (1.2% complete)   lr: 0.000730   
2022-05-29 20:10:00,837 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 4/99   Jobs: 3   Epoch: 0.10/6.0 (1.6% complete)   lr: 0.000723   
2022-05-29 20:29:52,690 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 5/99   Jobs: 3   Epoch: 0.12/6.0 (2.0% complete)   lr: 0.000717   
2022-05-29 20:49:44,228 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 6/99   Jobs: 4   Epoch: 0.14/6.0 (2.4% complete)   lr: 0.000947   
2022-05-29 21:16:16,927 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 7/99   Jobs: 4   Epoch: 0.17/6.0 (2.9% complete)   lr: 0.000935   
2022-05-29 21:42:44,508 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 8/99   Jobs: 4   Epoch: 0.21/6.0 (3.4% complete)   lr: 0.000924   
2022-05-29 22:09:25,170 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 9/99   Jobs: 4   Epoch: 0.24/6.0 (4.0% complete)   lr: 0.000913   
2022-05-29 22:35:54,090 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 10/99   Jobs: 4   Epoch: 0.27/6.0 (4.5% complete)   lr: 0.000902   
2022-05-29 23:02:25,617 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 11/99   Jobs: 4   Epoch: 0.30/6.0 (5.0% complete)   lr: 0.000891   
2022-05-29 23:29:06,344 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 12/99   Jobs: 4   Epoch: 0.33/6.0 (5.6% complete)   lr: 0.000880   
2022-05-29 23:55:40,598 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 13/99   Jobs: 4   Epoch: 0.37/6.0 (6.1% complete)   lr: 0.000869   
2022-05-30 00:21:58,951 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 14/99   Jobs: 4   Epoch: 0.40/6.0 (6.6% complete)   lr: 0.000859   
2022-05-30 00:48:19,347 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 15/99   Jobs: 4   Epoch: 0.43/6.0 (7.1% complete)   lr: 0.000848   
2022-05-30 01:14:52,615 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 16/99   Jobs: 4   Epoch: 0.46/6.0 (7.7% complete)   lr: 0.000838   
2022-05-30 01:41:10,718 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 17/99   Jobs: 5   Epoch: 0.49/6.0 (8.2% complete)   lr: 0.001035   
2022-05-30 02:14:22,780 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 18/99   Jobs: 5   Epoch: 0.53/6.0 (8.9% complete)   lr: 0.001019   
2022-05-30 02:47:34,917 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 19/99   Jobs: 5   Epoch: 0.57/6.0 (9.5% complete)   lr: 0.001004   
2022-05-30 03:20:41,669 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 20/99   Jobs: 5   Epoch: 0.61/6.0 (10.2% complete)   lr: 0.000989   
2022-05-30 03:53:56,326 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 21/99   Jobs: 5   Epoch: 0.65/6.0 (10.8% complete)   lr: 0.000974   
2022-05-30 04:27:12,361 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 22/99   Jobs: 5   Epoch: 0.69/6.0 (11.5% complete)   lr: 0.000959   
2022-05-30 05:00:13,847 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 23/99   Jobs: 5   Epoch: 0.73/6.0 (12.2% complete)   lr: 0.000945   
2022-05-30 05:33:20,889 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 24/99   Jobs: 5   Epoch: 0.77/6.0 (12.8% complete)   lr: 0.000930   
2022-05-30 06:06:29,659 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 25/99   Jobs: 5   Epoch: 0.81/6.0 (13.5% complete)   lr: 0.000916   
2022-05-30 06:39:34,601 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 26/99   Jobs: 5   Epoch: 0.85/6.0 (14.2% complete)   lr: 0.000902   
2022-05-30 07:12:44,992 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 27/99   Jobs: 5   Epoch: 0.89/6.0 (14.8% complete)   lr: 0.000889   
2022-05-30 07:45:51,452 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 28/99   Jobs: 6   Epoch: 0.93/6.0 (15.5% complete)   lr: 0.001050   
2022-05-30 08:25:42,381 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 29/99   Jobs: 6   Epoch: 0.98/6.0 (16.3% complete)   lr: 0.001031   
2022-05-30 09:05:38,244 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 30/99   Jobs: 6   Epoch: 1.02/6.0 (17.1% complete)   lr: 0.001013   
2022-05-30 09:45:28,618 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 31/99   Jobs: 6   Epoch: 1.07/6.0 (17.9% complete)   lr: 0.000994   
2022-05-30 10:25:18,491 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 32/99   Jobs: 6   Epoch: 1.12/6.0 (18.7% complete)   lr: 0.000976   
2022-05-30 11:05:05,278 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 33/99   Jobs: 6   Epoch: 1.17/6.0 (19.4% complete)   lr: 0.000959   
2022-05-30 11:44:54,175 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 34/99   Jobs: 6   Epoch: 1.21/6.0 (20.2% complete)   lr: 0.000941   
2022-05-30 12:25:25,417 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 35/99   Jobs: 6   Epoch: 1.26/6.0 (21.0% complete)   lr: 0.000924   
2022-05-30 13:05:52,806 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 36/99   Jobs: 6   Epoch: 1.31/6.0 (21.8% complete)   lr: 0.000907   
2022-05-30 13:46:32,688 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 37/99   Jobs: 6   Epoch: 1.36/6.0 (22.6% complete)   lr: 0.000891   
2022-05-30 14:26:57,233 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 38/99   Jobs: 6   Epoch: 1.40/6.0 (23.4% complete)   lr: 0.000875   
2022-05-30 15:07:29,322 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 39/99   Jobs: 7   Epoch: 1.45/6.0 (24.2% complete)   lr: 0.001002   
2022-05-30 15:54:42,978 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 40/99   Jobs: 7   Epoch: 1.51/6.0 (25.1% complete)   lr: 0.000981   
2022-05-30 16:41:47,978 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 41/99   Jobs: 7   Epoch: 1.56/6.0 (26.1% complete)   lr: 0.000960   
2022-05-30 17:29:04,061 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 42/99   Jobs: 7   Epoch: 1.62/6.0 (27.0% complete)   lr: 0.000940   
2022-05-30 18:16:23,323 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 43/99   Jobs: 7   Epoch: 1.67/6.0 (27.9% complete)   lr: 0.000920   
2022-05-30 19:03:43,523 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 44/99   Jobs: 7   Epoch: 1.73/6.0 (28.8% complete)   lr: 0.000901   
2022-05-30 19:50:51,035 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 45/99   Jobs: 7   Epoch: 1.79/6.0 (29.8% complete)   lr: 0.000882   
2022-05-30 20:38:05,742 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 46/99   Jobs: 7   Epoch: 1.84/6.0 (30.7% complete)   lr: 0.000863   
2022-05-30 21:25:18,755 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 47/99   Jobs: 7   Epoch: 1.90/6.0 (31.6% complete)   lr: 0.000845   
2022-05-30 22:12:33,401 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 48/99   Jobs: 7   Epoch: 1.95/6.0 (32.5% complete)   lr: 0.000827   
2022-05-30 22:59:56,403 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 49/99   Jobs: 7   Epoch: 2.01/6.0 (33.5% complete)   lr: 0.000810   
2022-05-30 23:47:11,672 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 50/99   Jobs: 8   Epoch: 2.06/6.0 (34.4% complete)   lr: 0.000906   
2022-05-31 00:41:17,054 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 51/99   Jobs: 8   Epoch: 2.13/6.0 (35.4% complete)   lr: 0.000884   
2022-05-31 01:35:06,756 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 52/99   Jobs: 8   Epoch: 2.19/6.0 (36.5% complete)   lr: 0.000863   
2022-05-31 02:29:03,858 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 53/99   Jobs: 8   Epoch: 2.25/6.0 (37.6% complete)   lr: 0.000842   
2022-05-31 03:23:09,736 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 54/99   Jobs: 8   Epoch: 2.32/6.0 (38.6% complete)   lr: 0.000822   
2022-05-31 04:17:15,231 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 55/99   Jobs: 8   Epoch: 2.38/6.0 (39.7% complete)   lr: 0.000802   
2022-05-31 05:11:10,363 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 56/99   Jobs: 8   Epoch: 2.44/6.0 (40.7% complete)   lr: 0.000783   
2022-05-31 06:05:13,460 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 57/99   Jobs: 8   Epoch: 2.51/6.0 (41.8% complete)   lr: 0.000764   
2022-05-31 06:59:16,943 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 58/99   Jobs: 8   Epoch: 2.57/6.0 (42.9% complete)   lr: 0.000746   
2022-05-31 07:53:19,043 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 59/99   Jobs: 8   Epoch: 2.63/6.0 (43.9% complete)   lr: 0.000728   
2022-05-31 08:47:20,472 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 60/99   Jobs: 8   Epoch: 2.70/6.0 (45.0% complete)   lr: 0.000710   
2022-05-31 09:41:08,400 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 61/99   Jobs: 8   Epoch: 2.76/6.0 (46.0% complete)   lr: 0.000693   
2022-05-31 10:35:00,397 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 62/99   Jobs: 9   Epoch: 2.83/6.0 (47.1% complete)   lr: 0.000761   
2022-05-31 11:35:55,630 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 63/99   Jobs: 9   Epoch: 2.90/6.0 (48.3% complete)   lr: 0.000740   
2022-05-31 12:36:43,619 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 64/99   Jobs: 9   Epoch: 2.97/6.0 (49.5% complete)   lr: 0.000720   
2022-05-31 13:37:42,803 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 65/99   Jobs: 9   Epoch: 3.04/6.0 (50.7% complete)   lr: 0.000701   
2022-05-31 14:38:33,424 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 66/99   Jobs: 9   Epoch: 3.11/6.0 (51.9% complete)   lr: 0.000682   
2022-05-31 15:39:23,208 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 67/99   Jobs: 9   Epoch: 3.18/6.0 (53.0% complete)   lr: 0.000663   
2022-05-31 16:40:05,935 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 68/99   Jobs: 9   Epoch: 3.25/6.0 (54.2% complete)   lr: 0.000645   
2022-05-31 17:41:05,669 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 69/99   Jobs: 9   Epoch: 3.33/6.0 (55.4% complete)   lr: 0.000628   
2022-05-31 18:42:00,647 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 70/99   Jobs: 9   Epoch: 3.40/6.0 (56.6% complete)   lr: 0.000611   
2022-05-31 19:42:48,242 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 71/99   Jobs: 9   Epoch: 3.47/6.0 (57.8% complete)   lr: 0.000594   
2022-05-31 20:43:39,005 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 72/99   Jobs: 9   Epoch: 3.54/6.0 (59.0% complete)   lr: 0.000578   
2022-05-31 21:44:30,012 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 73/99   Jobs: 10   Epoch: 3.61/6.0 (60.2% complete)   lr: 0.000625   
2022-05-31 22:52:13,637 [steps/nnet3/chain/train.py:535 - train - INFO ] Iter: 74/99   Jobs: 10   Epoch: 3.69/6.0 (61.5% complete)   lr: 0.000607   
